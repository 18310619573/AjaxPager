(function(n,t){var r=n.ajaxPager={opts:{pageSize:10,preText:"pre",nextText:"next",firstText:"First",lastText:"Last",shiftingLeft:3,shiftingRight:3,preLeast:2,nextLeast:2,showFirst:!0,showLast:!0,url:"",type:"POST",dataType:"JSON",searchParam:{},beforeSend:null,success:null,complete:null,error:function(){alert("抱歉,请求出错,请重新请求！")},pageIndex:1,totalCount:0,totalPage:0},pagerElement:null,commonHtmlText:{spanHtml:"<span class='{0}'>{1}<\/span>",pageIndexHtml:"<a href='javascript:void(0)' onclick='ajaxPager.doPage({0},{1},{2})'>{3}<\/a>",rightHtml:"<span class='text'> &nbsp; 共 {0} 页， 到第<\/span> <input type='text' id='txtToPager' value={1} /><span class='text'>页<\/span> <button id='btnJump' onclick='ajaxPager.jumpToPage();return false;' >跳转<\/button>",clearFloatHtml:"<div style='clear:both;'><\/div>",stringEmpty:""},init:function(n,i){var r=this;return r.opts=t.extend({},r.opts,i),r.pagerElement=n,r.doPage(r.opts.pageIndex,r.opts.pageSize,r.opts.searchParam),r.opts},doPage:function(n,i,r){var u=this;u.opts.pageIndex=n;u.opts.pageSize=i;u.opts.searchParam=r;t.ajax({type:u.opts.type,data:t.extend(u.opts.searchParam||{},{pageIndex:u.opts.pageIndex,pageSize:u.opts.pageSize||10}),dataType:u.opts.dataType,url:u.opts.url,beforeSend:function(){u.opts.beforeSend()},error:function(n,t,i){u.opts.error(n,t,i)},success:function(n){if(n=n,u.opts.success(n),u.opts.totalCount=n.total,u.getTotalPage(),u.opts.totalCount>0&&u.opts.pageIndex>0){var t=[];u.createPreAndFirstBtn(t);u.createIndexBtn(t);u.createNextAndLastBtn(t);u.renderHtml(t)}},complete:function(){u.opts.complete()}})},getTotalPage:function(){var n=this;n.opts.totalPage=Math.ceil(n.opts.totalCount/n.opts.pageSize)},createPreAndFirstBtn:function(n){var t=this;t.opts.pageIndex==1?(t.opts.showFirst&&n.push(t.createSpan(t.opts.firstText,"disenable")),n.push(t.createSpan(t.opts.preText,"disenable"))):(t.opts.showFirst&&n.push(t.createIndexText(1,t.opts.firstText)),n.push(t.createIndexText(t.opts.pageIndex-1,t.opts.preText)))},createNextAndLastBtn:function(n){var t=this;t.opts.pageIndex==t.opts.totalPage?(n.push(t.createSpan(t.opts.nextText,"disenable")),t.opts.showLast&&n.push(t.createSpan(t.opts.lastText,"disenable"))):(n.push(t.createIndexText(t.opts.pageIndex+1,t.opts.nextText)),t.opts.showLast&&n.push(t.createIndexText(t.opts.totalPage,t.opts.lastText)))},createIndexBtn:function(n){var t=this,r=t.opts.shiftingLeft+t.opts.preLeast+1,u=t.opts.totalPage-t.opts.shiftingRight-t.opts.nextLeast-1;if(t.opts.pageIndex>r){for(i=1;i<=t.opts.preLeast;i++)n.push(t.createIndexText(i,i));for(n.push(t.createSpan("...")),i=t.opts.pageIndex-t.opts.shiftingLeft;i<t.opts.pageIndex;i++)n.push(t.createIndexText(i,i))}else for(i=1;i<t.opts.pageIndex;i++)n.push(t.createIndexText(i,i));if(n.push(t.createSpan(t.opts.pageIndex,"current")),t.opts.pageIndex<=u){for(i=t.opts.pageIndex+1;i<t.opts.pageIndex+1+t.opts.shiftingRight;i++)n.push(t.createIndexText(i,i));for(n.push(t.createSpan("...")),i=t.opts.totalPage-1;i<=t.opts.totalPage;i++)n.push(t.createIndexText(i,i))}else for(i=t.opts.pageIndex+1;i<=t.opts.totalPage;i++)n.push(t.createIndexText(i,i))},renderHtml:function(n){for(var t=this,r=t.commonHtmlText.stringEmpty,i=0;i<n.length;i++)r+=n[i];t.pagerElement.html(r).append(stringFormat(t.commonHtmlText.rightHtml,t.opts.totalPage,t.opts.pageIndex)).append(t.commonHtmlText.clearFloatHtml)},createSpan:function(n,t){var i=this;return stringFormat(i.commonHtmlText.spanHtml,t?t:i.commonHtmlText.stringEmpty,n)},createIndexText:function(n,t){var i=this;return stringFormat(i.commonHtmlText.pageIndexHtml,n,i.opts.pageSize,JSON.stringify(i.opts.searchParam),t)},jumpToPage:function(){var n=this,r=t("#txtToPager",n.pagerElement),i=parseInt(r.val());!isNaN(i)&&i>0&&i<=n.opts.totalPage?n.doPage(i,n.opts.pageSize,n.opts.searchParam):r.focus()}};t.fn.asyncPager=function(n){return r.init(t(this),n)}})(window,jQuery);